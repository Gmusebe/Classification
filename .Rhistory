# Fit a simple linear regression model, with sales as the response and Tv as the predictor.
lm.fit = lm(sales~TV)
lm.fit
# The equation is: sales ~ 7.03259 + 0.04754 TV
ggplot(data, aes(x = TV, y = sales,, colour = "red")) + geom_point() + stat_smooth(method = lm, colour = "blue")+
ggtitle("Regression: TV vs SALES") + font("title", size = 29) +
ylab("Sales") + font("ylab", size = 20) +
xlab("TV Advertisement Budget(000)") + font("xlab", size = 20)
# _________________________________________________________
# MODEL ASSESMENT(Quality of the model)
# ________________________________________________________
summary(lm.fit)
# _________________________________________________________
# Assessing the Accuracy of the Coefficient Estimates(Coefficients significance)
# Does TV as a media contribute to sales?
#   Examine the p-values associated with each predictor's t-statistic
#   H0 : ??1 = 0
#   Ha : ??1 != 0
summary(lm.fit)$coefficient
#             Estimate  Std. Error  t value Pr(>|t|)
# (Intercept) 7.032594   0.457843   15.36   <2e-16 ***
# TV          0.047537   0.002691   17.67   <2e-16 ***
#             p-value: < 2.2e-16
# p < 0.05 There is a significant association between TV and sales
# Both the p-values ( Pr(r|t|) ) for the intercept and the predictor variable are highly significant,
# Reject null hypothesis and accept the alternative hypothesis: There is a relationship existing between X and Y.
# Confidence Interval for the model:
confint(lm.fit)
# That is, there is approximately a 95% chance that the interval [0.042, 0.053] will contain the true value of b1
#_______________________________________________________
# MODEL ACCURACY
# _______________________________________________________
# Assessing the Accuracy of the Model(This process is also referred to as the goodness-of-fit)
# How well does the model fit the data?
# Having established there being a significant relationship between TV advertisement budget and sales,
# determine the extent to which the model fits:
# 1. Residual Standard Error
cat("RSE: ",sigma(lm.fit), "\n")
#____________________________
# RSE is the residual variation
# RSE provides an absolute measure of patterns in the data that can't be explained by the model. The smaller the RSE, the better the model.
# Actual sales in each market deviate from the true regression line by approximately 3,259 units, on average.
# Prediction Error rate.
# Itâ€™s a measure of how well the model predicts the response variable.
# It is found by diving the RSE by the mean of sales: (RSE/mean(sales):
cat("PE:",sigma(lm.fit)/mean(sales), "\n") # 23% error rate
# 2. R-Squared
cat("R-squared: ",summary(lm.fit)$r.squared, "\n") # Equal to square of pearson coefficient[cor(sales, TV)^2]
#This tell us that 61.19% of variability in the response has been explained by the model.
# 3. F-statistic
# The F-statistic gives the overall significance of the model.
cat("F-statistic: \n", summary(lm.fit)$fstatistic, fill = 1)
# F-value = 312.145 with 1 degree of freedom, p-value 2.2e-16 which is highly significant.
# Pediction
lm.fit %>% predict(data.frame(TV =c(4))) # input a value of TV advertisement budget in the place of 4. I f multiple values then: c(a, b, c)
library(MASS)
library(ISLR)
library(dplyr)
library(tidyverse)
librar(ggpubr)
theme_set(theme_pubr())
library(ggpubr)
theme_set(theme_pubr())
path = "http://faculty.marshall.usc.edu/gareth-james/ISL/Advertising.csv"
data = read.csv(path, header = TRUE, na.stringr = "?")
View(data)
cor(data)
# Import libraries
library(MASS)
library(ISLR)
library(tidyverse)
library(dplyr)
library(ggpubr)
# Setting visualisation theme
theme_set(theme_pubr())
# Import data
path = "http://faculty.marshall.usc.edu/gareth-james/ISL/Advertising.csv"
data = read.csv(path, header = TRUE)
View(data)
data <- data[, -1]
View(Data)
View(data)
install.packages("ggcorrplot")
ggcorrplot(data, hc.order = TRUE, type = "lower",
outline.col = "white",
ggtheme = ggplot2::theme_gray,
colors = c("#6D9EC1", "white", "#E46726"))
library(ggcorrplot)
ggcorrplot(data, hc.order = TRUE, type = "lower",
outline.col = "white",
ggtheme = ggplot2::theme_gray,
colors = c("#6D9EC1", "white", "#E46726"))
ggcorrplot(round(cor(data), 1), hc.order = TRUE, type = "lower",
outline.col = "white",
ggtheme = ggplot2::theme_gray,
colors = c("#6D9EC1", "white", "#E46726"))
round(cor(data), 1)
ggcorrplot(round(cor(data), 1), type = "lower",
outline.col = "white",
ggtheme = ggplot2::theme_gray,
colors = c("#6D9EC1", "white", "#E46726"))
ggcorrplot(round(cor(data), 1), hc.order = TRUE,
outline.col = "white",
ggtheme = ggplot2::theme_gray,
colors = c("#6D9EC1", "white", "#E46726"))
ggcorrplot(round(cor(data), 1), hc.order = TRUE, type = "lower",
outline.col = "white",
ggtheme = ggpubr::theme_pubr(),
colors = c("#6D9EC1", "white", "#E46726"))
ggcorrplot(round(cor(data), 1), hc.order = TRUE, type = "lower",
outline.col = "white",
ggtheme = ggpubr::theme_transparent(),
colors = c("#6D9EC1", "white", "#E46726"))
ggcorrplot(round(cor(data), 1), hc.order = TRUE, type = "lower",
outline.col = "white",
ggtheme = ggpubr::theme_transparent(),
colors = c("#6D9EC1", "white", "#E46726"),
lab = TRUE)
ggcorrplot(round(cor(data), 1), hc.order = TRUE, type = "lower",
outline.col = "white",
ggtheme = ggpubr::theme_classic2(),
colors = c("#6D9EC1", "white", "#E46726"),
lab = TRUE)
attach(data)
lm.fit = lm(sales~TV+radio+newspaper)
summary(lm.fit)
# Multiple Linear Regression
lm.fit = lm(sales~TV+radio+newspaper, data = data)
summary(lm.fit)
ls(lm.fit)
lm.fit = lm(sales~., data = data)
summary(lm.fit)
?summary.lm
library(car)
vif(lm.fit)
lm.fit = lm(sales~.+ I(TV^2), data = data)
summary(lm.fit)
lm.fit = lm(sales~.+ I(c(TV,radio, newspaper)^2), data = data)
summary(lm.fit)
lm.fit = lm(sales~.+ I(newspaper^2), data = data)
summary(lm.fit)
lm.fit = lm(sales~.+ I(radio^2), data = data)
summary(lm.fit)
# Multiple Linear Regression
lm.fit = lm(sales~.+ poly(TV, 5), data = data)
summary(lm.fit)
lm.fit = lm(sales~.-TV + poly(TV, 5), data = data)
summary(lm.fit)
fix(Carseats)
lm.fit = lm(sales~., data = data)
summary(lm.fit)
sigma(lm.fit)
confint(lm.fit)
round(confint(lm.fit), 3)
vif(lm.fit)
plot (sales, resid(lm.fit))
par(mfrow = c(2,2))
plot(lm.fit)
library(MASS)
library(ISLR)
library(tidyverse)
library(dplyr)
library(ggpubr)
library(car)
path = "http://faculty.marshall.usc.edu/gareth-james/ISL/Advertising.csv"
data = read.csv(path, header = TRUE)
attach(data)
data <- data[, -1]
lm.fit = lm(sales~., data = data)
summary(lm.fit)
par(mfrow = c(2,2))
plot(lm.fit)
View(data)
lm.fit = lm(sales~TV)
par(mforw = c(2, 2))
par(mfrow = c(2, 2))
plot(lm.fit)
data$predicted <- predict(lm.fit)
data$residuals <- residuals(lm.fit)
View(data)
View(data)
data %>% select(sales, predicted, residuals) %>% head()
ggplot(data, aes(x = TV, y = sales)) + geom_point()
ggplot(data, aes(x = TV, y = sales)) + geom_point() + geom_point(aes(y = predicted), shape = 1)
ggplot(data, aes(x = TV, y = sales)) +
geom_point() +
geom_point(aes(y = prediced), shape = 1)
ggplot(data, aes(x = TV, y = sales)) +
geom_point() +
geom_point(aes(y = predicted), shape = 1)
ggplot(data, aes(x = TV, y = sales)) + geom_segment(aes(xend = TV, yend = predicted)) + geom_point() +
geom_point(aes(y = predicted), shape = 1)
ggplot(data, aes(x = TV, y = sales)) +
geom_segment(aes(xend = TV, yend = predicted)) +
geom_point()+
geom_point(aes(y = predicted), shape = 1)
ggplot(data, aes(x = TV, y = sales)) +
geom_smooth(methd = "lm", se = FALSE, color = "lightgrey") +
geom_segment(aes(xend = TV, yend = predicted), alpha = .2) +
geom_point()+
geom_point(aes(y = predicted), shape = 1) +
theme_bw()
ggplot(data, aes(x = TV, y = sales)) +
geom_smooth(method = "lm", se = FALSE, color = "lightgrey") +
geom_segment(aes(xend = TV, yend = predicted), alpha = .2) +
geom_point()+
geom_point(aes(y = predicted), shape = 1) +
theme_bw()
ggplot(data, aes(x = TV, y = sales)) +
geom_smooth(method = "lm", se = FALSE, color = "lightgrey") +
geom_segment(aes(xend = TV, yend = predicted), alpha = .2) +
geom_point(aes(alpha = abs(residuals)))+
guides(alpha = FALSE)+
geom_point(aes(y = predicted), shape = 1) +
theme_bw()
library(MASS)
library(ISLR)
library(dplyr)
library(tidyverse)
library(ggpubr)
theme_set(theme_pubr())
path = "http://faculty.marshall.usc.edu/gareth-james/ISL/Advertising.csv"
data <- read.csv(path, header = TRUE, na.strings = "?")
attach(data)
# Fit a simple linear regression model, with sales as the response and Tv as the predictor.
lm.fit = lm(sales~TV)
lm.fit
summary(lm.fit)
ggplot(data , aes(x = TV, y = sales)) +
geom_point()+
geom_point(aes(y = predicted))
data$predicted <- predict(lm.fit)
data$residuals <- residuals(lm.fit)
ggplot(data, aes(x = TV, y = sales)) +
geom_point() +
geom_point(aes(y = predicted))
ggplot(data, aes(x = TV, y = sales)) +
geom_point() +
geom_point(aes(y = predicted), shape = 1)
ggplot(data, aes(x = TV, y = sales)) +
geom_segment(aes(xend = TV, yend = predicted)) +
geom_point() +
geom_point(aes(y = predicted), shape = 1)
ggplot(data, aes(x = TV, y = sales)) +
geom_smooth(method = "lm", se = FALSE, color = "#00AFBB")
geom_segment(aes(xend = TV, yend = predicted), alpha = .2)  +
geom_point() +
geom_point(aes(y = predicted), shape = 1)
ggplot(data, aes(x = TV, y = sales)) +
geom_smooth(method = "lm", se = FALSE, color = "#00AFBB") +
geom_segment(aes(xend = TV, yend = predicted), alpha = .2)  +
geom_point() +
geom_point(aes(y = predicted), shape = 1)
ggplot(data, aes(x = TV, y = sales)) +
geom_smooth(method = "lm", color = "#00AFBB") +
geom_segment(aes(xend = TV, yend = predicted), alpha = .2)  +
geom_point() +
geom_point(aes(y = predicted), shape = 1)
ggplot(data, aes(x = TV, y = sales)) +
geom_smooth(method = "lm", se = FALSE, color = "#00AFBB") +
geom_segment(aes(xend = TV, yend = predicted), alpha = .2)  +
geom_point(aes(alpha = abs(residuals))) +
geom_point(aes(y = predicted), shape = 1)
ggplot(data, aes(x = TV, y = sales)) +
geom_smooth(method = "lm", se = FALSE, color = "#00AFBB") +
geom_segment(aes(xend = TV, yend = predicted), alpha = .2)  +
geom_point(aes(color = abs(residuals))) +
scale_color_continuous(low = "black", high = "red") +
guides(color = FALSE) +
geom_point(aes(y = predicted), shape = 1)
ggplot(data, aes(x = TV, y = sales)) +
geom_smooth(method = "lm", se = FALSE, color = "#00AFBB") +
geom_segment(aes(xend = TV, yend = predicted), alpha = .2)  +
geom_point(aes(color = abs(residuals), size = abs(residuals))) +
scale_color_continuous(low = "black", high = "red") +
guides(color = FALSE, size = FALSE) +
geom_point(aes(y = predicted), shape = 1)
ggplot(data, aes(x = TV, y = sales)) +
geom_smooth(method = "lm", se = FALSE, color = "#00AFBB") +
geom_segment(aes(xend = TV, yend = predicted), alpha = .2)  +
geom_point(aes(color = residuals)) +
scale_color_gradient(low = "blue", mid = "white", high = "red") +
guides(color = FALSE) +
geom_point(aes(y = predicted), shape = 1)
ggplot(data, aes(x = TV, y = sales)) +
geom_smooth(method = "lm", se = FALSE, color = "#00AFBB") +
geom_segment(aes(xend = TV, yend = predicted), alpha = .2)  +
geom_point(aes(color = residuals)) +
scale_color_gradient2(low = "blue", mid = "white", high = "red") +
guides(color = FALSE) +
geom_point(aes(y = predicted), shape = 1)
lm.fit1 = lm(sales~., data = data)
summary(lm.fit1)
lm.fit1 = lm(sales~.-c(predicted, residuals), data = data)
summary(lm.fit1)
lm.fit1 = lm(sales~.-predicted -residuals, data = data)
summary(lm.fit1)
data <- data[, -1]
lm.fit1 = lm(sales~.-predicted -residuals, data = data)
summary(lm.fit1)
vif(lm.fit1)
sigma(lm.fit1)
data$M_predictions <- predict(lm.fit1)
data$M_residuals <- residuals(lm.fit1)
View(data)
ggplot(data, aes(x = TV, y = sales)) +
geom_segment(aes(xend = TV, yend = predicted), alpha = .2) +
geom_point() +
geom_point(aes(y = predicted), shape = 1)
ggplot(data, aes(x = TV, y = sales)) +
geom_segment(aes(xend = TV, yend = predicted), alpha = .2) +
geom_point(aes(color = residuals)) +
scale_color_gradient2(low = "blue", mid = "white", high = "red") +
guides(color = FALSE) +
geom_point(aes(y = predicted), shape = 1)
ggplot(data, aes(x = TV, y = sales)) +
geom_segment(aes(xend = TV, yend = M_predicted), alpha = .2) +
geom_point(aes(color = M_residuals)) +
scale_color_gradient2(low = "blue", mid = "white", high = "red") +
guides(color = FALSE) +
geom_point(aes(y = M_predicted), shape = 1)
ggplot(data, aes(x = TV, y = sales)) +
geom_segment(aes(xend = TV, yend = M_predictions), alpha = .2) +
geom_point(aes(color = M_residuals)) +
scale_color_gradient2(low = "blue", mid = "white", high = "red") +
guides(color = FALSE) +
geom_point(aes(y = M_predictions), shape = 1)
library(tidyr)
data %>%
gather(key = "iv", value = "x", -sales, -predicted, -residuals, -M_predictions, - M_residuals) %>%
head()
M_data <- data %>% select(TV, newspaper, radio, sales, M_predictions, M_residuals)
View(M_data)
M_data %>%
gather(key = "iv", value = "x", -sales, -M_predictions, -M_residuals) %>%
ggplot(data, aes(x = x, y = sales)) +
geom_segment(aes(xend = x, yend = M_predictions), alpha = .2) +
geom_point(aes(color = M_residuals)) +
scale_color_gradient2(low = "blue", mid = "white", high = "red") +
guides(color = FALSE) +
geom_point(aes(y = M_predictions), shape = 1)
M_data %>%
gather(key = "iv", value = "x", -sales, -M_predictions, -M_residuals) %>%  head()
M_data %>%
gather(key = "iv", value = "x", -c(sales, M_predictions, M_residuals)) %>%  head()
M_data %>%
gather(key = "iv", value = "x", -c(sales, M_predictions, M_residuals)) %>%
ggplot(M_data, aes(x = x, y = sales)) +
geom_segment(aes(xend = x, yend = M_predictions), alpha = .2) +
geom_point(aes(color = M_residuals)) +
scale_color_gradient2(low = "blue", mid = "white", high = "red") +
guides(color = FALSE) +
geom_point(aes(y = M_predictions), shape = 1)
M_data %>%
gather(key = "iv", value = "x", -c(sales, M_predictions, M_residuals)) %>%
ggplot(aes(x = x, y = sales)) +
geom_segment(aes(xend = x, yend = M_predictions), alpha = .2) +
geom_point(aes(color = M_residuals)) +
scale_color_gradient2(low = "blue", mid = "white", high = "red") +
guides(color = FALSE) +
geom_point(aes(y = M_predictions), shape = 1)
M_data %>%
gather(key = "iv", value = "x", -c(sales, M_predictions, M_residuals)) %>%
ggplot(aes(x = x, y = sales)) +
geom_segment(aes(xend = x, yend = M_predictions), alpha = .2) +
geom_point(aes(color = M_residuals)) +
scale_color_gradient2(low = "blue", mid = "white", high = "red") +
guides(color = FALSE) +
geom_point(aes(y = M_predictions), shape = 1 ) +
facet_grid(~ iv, scales = "free_x")
ggplot(data, aes(x = TV, y = sales)) +
geom_point() +
stat_smooth(colour = "red") +
ggtitle("TV vs SALES") + font("title", size = 29) +
ylab("Sales") + font("ylab", size = 20) +
xlab("TV Advertisement Budget(000)") + font("xlab", size = 20)
lm.fit = lm(sales~TV)
lm.fit
ggplot(data, aes(x = TV, y = sales, colour = "red")) +
geom_point() + stat_smooth(method = lm, colour = "blue")+
ggtitle("Regression: TV vs SALES") + font("title", size = 29) +
ylab("Sales") + font("ylab", size = 20) +
xlab("TV Advertisement Budget(000)") + font("xlab", size = 20)
ggplot(data, aes(x = TV, y = sales, colour = "red",)) +
guides(color = FALSE)
geom_point() + stat_smooth(method = lm, colour = "blue")+
ggtitle("Regression: TV vs SALES") + font("title", size = 29) +
ylab("Sales") + font("ylab", size = 20) +
xlab("TV Advertisement Budget(000)") + font("xlab", size = 20)
ggplot(data, aes(x = TV, y = sales, colour = "red",)) +
geom_point() + stat_smooth(method = lm, colour = "blue")+
ggtitle("Regression: TV vs SALES") + font("title", size = 29) +
ylab("Sales") + font("ylab", size = 20) +
xlab("TV Advertisement Budget(000)") + font("xlab", size = 20)
ggplot(data, aes(x = TV, y = sales, colour = "red",)) +
geom_point() + stat_smooth(method = lm, colour = "blue")+
ggtitle("Regression: TV vs SALES") + font("title", size = 25) +
ylab("Sales") + font("ylab", size = 15) +
xlab("TV Advertisement Budget(000)") + font("xlab", size = 15)
ggplot(data, aes(x = TV, y = sales, colour = "red",)) +
geom_point() + stat_smooth(method = lm, colour = "blue", se = FALSE)+
ggtitle("Regression: TV vs SALES") + font("title", size = 25) +
ylab("Sales") + font("ylab", size = 15) +
xlab("TV Advertisement Budget(000)") + font("xlab", size = 15)
ggplot(data, aes(x = TV, y = sales, colour = "red",)) +
geom_point() + stat_smooth(method = lm, colour = "blue", se = FALSE)+
ggtitle("Regression: TV vs SALES") + font("title", size = 20) +
ylab("Sales") + font("ylab", size = 15) +
xlab("TV Advertisement Budget(000)") + font("xlab", size = 15)
summary(lm.fit)
sigma(lm.fit)
lm.fit$r.squared
lm.fit$r.sq
summary(lm.fit)$r.sq
confint(lm.fit)
(cor(Tv, sales))^2
(cor(TV, sales))^2
lm.fit %>% predict(data.frame(TV =c(4)))
setwd("D:/Statistics/Classification")
# Import libraries:
library(tidyverse)
library(visdat)
library(caret)
library(ggpubr)
library(magrittr)
library(dplyr)
theme_set(theme_pubr())
# Data source: https://archive.ics.uci.edu/ml/datasets/Heart+Disease
class_data <- read.csv("HeartICU.csv")
attach(class_data)
View(class_data)
names(class_data)
# Data structure:
str(class_data)
cols <- c(2, 3, 6, 7, 9, 14)
class_data[, cols] <- lapply(class_data[, cols], factor)
str(class_data)
head(class_data[, is.factor(class_data)])
head(class_data[, sapply(class_data, is.factor)])
head(class_data[, -sapply(class_data, is.factor)])
head(class_data[, sapply(class_data, is.factor == FALSE)])
head(class_data[, sapply(class_data, is.factor) == TRUE])
head(class_data[, sapply(class_data, is.factor) == FALSE])
cor(class_data[, sapply(class_data, is.factor) == FALSE])
library(tidyverse)
library(visdat)
library(caret)
library(ggpubr)
library(dplyr)
theme_set(theme_pubr())
class_data <- read.csv("HeartICU.csv")
attach(class_data)
cols <- c(2, 3, 6, 7, 9, 14)
class_data[, cols] <- lapply(class_data[, cols], factor)
visdat::vis_dat(class_data)
vis_dat(class_data)
cor(class_data[, sapply(class_data, is.factor) == FALSE])
set.seed(123)
train <- class_data$target %>%
createDataPartition(p =0.8, list = FALSE)
train.data <- class_data[train,]
test.data <- class_data[-train, ]
glm_fit <- glm(target~., data = class_data, family = binomial(link = "logit"))
summary(glm_fit)
probabilities  <- glm_fit %>% predict(test.data, type = "response")
contrasts(target)
pred_target <- ifelse(probabilities > 0.5, 1, 0)
mean(pred_target == test.data$target)
mean(Pred_target != test.data$target)
mean(pred_target != test.data$target)
library(epiDisplay)
tab1(test.data$target, pred_target)
table(test.data$target, pred_target)
# Estimate
pre_proc <- train.data %>%
preProcess(method = c("scale", "center"))
train.trans <- pre_proc %>% predict(train.data)
test.trans <- pre_proc %>% predict(test.data)
lda.fit <- lda(target~., data = train.trans)
plot(lda.fit)
lda.fit
lda_pred <- lda.fit %>% predict(test.trans)
mean(lda_pred$class == test.trans$target)
install.packages("gmodels")
library(gmodels)
set.seed(123)
knn_model <- train(
target~., data = train.data, method = "knn",
trControl = trainControl("cv", number = 13),
preProcess = c("center", "scale"),
tuneLength = 20
)
plot(knn_model)
knn_model$bestTune
#Predictions:
knn_pred <- knn_model %>% predict(test.data)
CrossTable(x = test.data$target, knn_pred)
mean(knn_pred == test.data$target)
RMSE(knn_pred, test.data$target)
set.seed(123)
knnmodel <- train(
target~., data = train.data, method = "knn",
trControl = trainControl("cv", number = 13),
preProcess = c("center", "scale"),
tuneLength = 31
)
plot(knnmodel)
knnmodel$bestTune
knnpred <- knnmodel %>% predict(test.data)
mean(knnpred == test.data$target)
RMSE(knnpred, test.data$target)
RMSE(knnpred, test.data$target)
